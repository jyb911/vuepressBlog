{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{455:function(t,a,s){\"use strict\";s.r(a);var e=s(56),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":t.$parent.slotKey}},[s(\"h2\",{attrs:{id:\"同源策略\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#同源策略\"}},[t._v(\"#\")]),t._v(\" 同源策略\")]),t._v(\" \"),s(\"ul\",[s(\"li\",[t._v(\"默认阻止跨域获取资源\")])]),t._v(\" \"),s(\"h2\",{attrs:{id:\"cors\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#cors\"}},[t._v(\"#\")]),t._v(\" CORS\")]),t._v(\" \"),s(\"ul\",[s(\"li\",[t._v(\"CORS：Cross-Origin Resource Sharing （跨域资源共享），它由一系列传输的HTTP 头组成，这些 HTTP 头决定浏览器是否阻止前端 JavaScript 代码获取跨域请求的响应，所以通过配置CORS对应规则，跨域请求就可以正常进行。\")])]),t._v(\" \"),s(\"h3\",{attrs:{id:\"cors头\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#cors头\"}},[t._v(\"#\")]),t._v(\" cors头\")]),t._v(\" \"),s(\"ul\",[s(\"li\",[t._v(\"Access-Control-Allow-Origin：指示请求的资源可以共享给哪些域\")]),t._v(\" \"),s(\"li\",[t._v(\"Access-Control-Allow-Credentials：指示当请求凭证为true时是否响应该请求\")]),t._v(\" \"),s(\"li\",[t._v(\"Access-Control-Allow-Headers：用在预检请求的响应中，指示实际请求可以使用哪些HTTP头\")]),t._v(\" \"),s(\"li\",[t._v(\"Access-Control-Allow-Methods：用在预检请求的响应中，指示实际请求可以使用哪些请求方法\")]),t._v(\" \"),s(\"li\",[t._v(\"Access-Control-Expose-Methods：指示哪些 HTTP 头的名称能在响应中列出\")]),t._v(\" \"),s(\"li\",[t._v(\"Access-Control-Max-Age：预检请求结果能被缓存多久\")]),t._v(\" \"),s(\"li\",[t._v(\"Access-Control-Request-Headers：用于发起一个预检请求，告知服务器正式请求会使用那些 HTTP 头\")]),t._v(\" \"),s(\"li\",[t._v(\"Access-Control-Request-Methods：用于发起一个预检请求，告知服务器正式请求会使用那些 请求方法\")]),t._v(\" \"),s(\"li\",[t._v(\"Origin：指示获取资源的请求是从什么域发起的\")])]),t._v(\" \"),s(\"h2\",{attrs:{id:\"跨域请求流程\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#跨域请求流程\"}},[t._v(\"#\")]),t._v(\" 跨域请求流程\")]),t._v(\" \"),s(\"h3\",{attrs:{id:\"简单请求\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#简单请求\"}},[t._v(\"#\")]),t._v(\" 简单请求\")]),t._v(\" \"),s(\"ul\",[s(\"li\",[t._v(\"请求方法是HEAD/GET/POST\")]),t._v(\" \"),s(\"li\",[t._v(\"请求体文件类型只能是form-urlencoded、form-data、text/plain\")])]),t._v(\" \"),s(\"h4\",{attrs:{id:\"请求过程\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#请求过程\"}},[t._v(\"#\")]),t._v(\" 请求过程\")]),t._v(\" \"),s(\"ol\",[s(\"li\",[t._v(\"浏览器发起请求，自动加上请求来源Origin给服务器检查\")]),t._v(\" \"),s(\"li\",[t._v(\"服务器返回数据，并返回检查结果，配置CORS响应头\")]),t._v(\" \"),s(\"li\",[t._v(\"浏览器检查CORS响应头，如果包含当前源就放行，反之拦截\")])]),t._v(\" \"),s(\"h3\",{attrs:{id:\"复杂请求\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#复杂请求\"}},[t._v(\"#\")]),t._v(\" 复杂请求\")]),t._v(\" \"),s(\"h4\",{attrs:{id:\"请求过程-2\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#请求过程-2\"}},[t._v(\"#\")]),t._v(\" 请求过程\")]),t._v(\" \"),s(\"ol\",[s(\"li\",[t._v(\"浏览器使用 OPTIONS 方法发起预检请求，预检请求报文中的 Access-Control-Request-Method首部字段告知服务器实际请求所使用的 HTTP 方法；Access-Control-Request-Headers 首部字段告知服务器实际请求所携带的自定义首部字段，并自动加上请求来源Origin\")]),t._v(\" \"),s(\"li\",[t._v(\"服务器返回检查结果，配置Access-Control-Allow-Origin、Access-Control-Allow-Methods、Access-Control-Allow-Headers、Access-Control-Max-Age等http头部字段\")]),t._v(\" \"),s(\"li\",[t._v(\"浏览器发起真正请求\")]),t._v(\" \"),s(\"li\",[t._v(\"服务器返回数据\")])]),t._v(\" \"),s(\"h3\",{attrs:{id:\"携带身份凭证的请求\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#携带身份凭证的请求\"}},[t._v(\"#\")]),t._v(\" 携带身份凭证的请求\")]),t._v(\" \"),s(\"ul\",[s(\"li\",[t._v(\"预检请求不能包含凭证\")]),t._v(\" \"),s(\"li\",[t._v(\"预检请求的响应必须指定Access-Control-Allow-Credentials为true来表明实际请求可以携带凭证进行请求\")]),t._v(\" \"),s(\"li\",[t._v(\"在响应附带身份凭证的请求时：\\n\"),s(\"ul\",[s(\"li\",[t._v(\"服务器不能将 \"),s(\"code\",[t._v(\"Access-Control-Allow-Origin\")]),t._v(\" 的值设为通配符“\"),s(\"code\",[t._v(\"*\")]),t._v(\"”，而应将其设置为特定的域，如：\"),s(\"code\",[t._v(\"Access-Control-Allow-Origin: https://example.com\")]),t._v(\"。\")]),t._v(\" \"),s(\"li\",[t._v(\"服务器不能将 \"),s(\"code\",[t._v(\"Access-Control-Allow-Headers\")]),t._v(\" 的值设为通配符“\"),s(\"code\",[t._v(\"*\")]),t._v(\"”，而应将其设置为首部名称的列表，如：\"),s(\"code\",[t._v(\"Access-Control-Allow-Headers: X-PINGOTHER, Content-Type\")])]),t._v(\" \"),s(\"li\",[t._v(\"服务器不能将 \"),s(\"code\",[t._v(\"Access-Control-Allow-Methods\")]),t._v(\" 的值设为通配符“\"),s(\"code\",[t._v(\"*\")]),t._v(\"”，而应将其设置为特定请求方法名称的列表，如：\"),s(\"code\",[t._v(\"Access-Control-Allow-Methods: POST, GET\")])])])])]),t._v(\" \"),s(\"h2\",{attrs:{id:\"csrf\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#csrf\"}},[t._v(\"#\")]),t._v(\" CSRF\")]),t._v(\" \"),s(\"ul\",[s(\"li\",[t._v(\"CSRF：Cross Site Request Forgery （跨站请求伪造）\")])]),t._v(\" \"),s(\"p\",[s(\"a\",{attrs:{href:\"https://imgse.com/i/vr6hND\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s(\"img\",{attrs:{src:\"https://s1.ax1x.com/2022/08/19/vr6hND.jpg\",alt:\"vr6hND.jpg\"}}),s(\"OutboundLink\")],1)]),t._v(\" \"),s(\"ol\",[s(\"li\",[t._v(\"用户登录受害网站，把获取的身份凭证保存在浏览器的cookie中\")]),t._v(\" \"),s(\"li\",[t._v(\"用户用同一浏览器访问黑客网站，黑客网站向受害网站服务器发起一个恶意请求，浏览器自动从cookie中取出身份凭证，把它带上\")]),t._v(\" \"),s(\"li\",[t._v(\"受害网站服务器发现身份凭证，恶意请求成功\")])]),t._v(\" \"),s(\"hr\"),t._v(\" \"),s(\"blockquote\",[s(\"p\",[t._v(\"以下出自美团技术团队博客\")])]),t._v(\" \"),s(\"h3\",{attrs:{id:\"常见攻击类型\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#常见攻击类型\"}},[t._v(\"#\")]),t._v(\" 常见攻击类型\")]),t._v(\" \"),s(\"h4\",{attrs:{id:\"get类型\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#get类型\"}},[t._v(\"#\")]),t._v(\" get类型\")]),t._v(\" \"),s(\"div\",{staticClass:\"language-html extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-html\"}},[s(\"code\",[s(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[s(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"<\")]),t._v(\"img\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[t._v(\"src\")]),s(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[s(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[t._v(\"=\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')]),t._v(\"http://bank.example/withdraw?amount=10000&for=hacker\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')])]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\">\")])]),t._v(\" \\n\")])])]),s(\"ul\",[s(\"li\",[t._v(\"受害者访问含有这个img 的页面时，浏览器会自动向目标服务器发送http请求\")])]),t._v(\" \"),s(\"h4\",{attrs:{id:\"post类型\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#post类型\"}},[t._v(\"#\")]),t._v(\" post类型\")]),t._v(\" \"),s(\"div\",{staticClass:\"language-html extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-html\"}},[s(\"code\",[s(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[s(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"<\")]),t._v(\"form\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[t._v(\"method\")]),s(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[s(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[t._v(\"=\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')]),t._v(\"POST\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')])]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[t._v(\"action\")]),s(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[s(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[t._v(\"=\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')]),t._v(\"https://mail.google.com/mail/h/ewt1jmuj4ddv/?v=prf\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')])]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[t._v(\"enctype\")]),s(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[s(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[t._v(\"=\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')]),t._v(\"multipart/form-data\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')])]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\">\")])]),t._v(\" \\n    \"),s(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[s(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"<\")]),t._v(\"input\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[t._v(\"type\")]),s(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[s(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[t._v(\"=\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')]),t._v(\"hidden\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')])]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[t._v(\"name\")]),s(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[s(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[t._v(\"=\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')]),t._v(\"cf2_emc\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')])]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[t._v(\"value\")]),s(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[s(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[t._v(\"=\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')]),t._v(\"true\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')])]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"/>\")])]),t._v(\" \\n    \"),s(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[s(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"<\")]),t._v(\"input\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[t._v(\"type\")]),s(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[s(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[t._v(\"=\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')]),t._v(\"hidden\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')])]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[t._v(\"name\")]),s(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[s(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[t._v(\"=\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')]),t._v(\"cf2_email\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')])]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[t._v(\"value\")]),s(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[s(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[t._v(\"=\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')]),t._v(\"hacker@hakermail.com\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')])]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"/>\")])]),t._v(\" \\n    .....\\n    \"),s(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[s(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"<\")]),t._v(\"input\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[t._v(\"type\")]),s(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[s(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[t._v(\"=\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')]),t._v(\"hidden\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')])]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[t._v(\"name\")]),s(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[s(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[t._v(\"=\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')]),t._v(\"irf\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')])]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[t._v(\"value\")]),s(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[s(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[t._v(\"=\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')]),t._v(\"on\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')])]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"/>\")])]),t._v(\" \\n    \"),s(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[s(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"<\")]),t._v(\"input\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[t._v(\"type\")]),s(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[s(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[t._v(\"=\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')]),t._v(\"hidden\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')])]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[t._v(\"name\")]),s(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[s(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[t._v(\"=\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')]),t._v(\"nvp_bu_cftb\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')])]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[t._v(\"value\")]),s(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[s(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[t._v(\"=\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')]),t._v(\"Create Filter\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')])]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"/>\")])]),t._v(\" \\n\"),s(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[s(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"</\")]),t._v(\"form\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\">\")])]),t._v(\" \\n\"),s(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[s(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"<\")]),t._v(\"script\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\">\")])]),s(\"span\",{pre:!0,attrs:{class:\"token script\"}},[s(\"span\",{pre:!0,attrs:{class:\"token language-javascript\"}},[t._v(\" \\n    document\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"forms\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),s(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"0\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"submit\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\")])]),s(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[s(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"</\")]),t._v(\"script\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\">\")])]),t._v(\"\\n\")])])]),s(\"ul\",[s(\"li\",[t._v(\"这个页面只要打开就会自动向Gmail发送请求，并且携带浏览器内的用户登录凭证，Gmail后台验证通过\")])]),t._v(\" \"),s(\"h4\",{attrs:{id:\"链接类型\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#链接类型\"}},[t._v(\"#\")]),t._v(\" 链接类型\")]),t._v(\" \"),s(\"div\",{staticClass:\"language-html extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-html\"}},[s(\"code\",[t._v(\"  \"),s(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[s(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"<\")]),t._v(\"a\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[t._v(\"href\")]),s(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[s(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[t._v(\"=\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')]),t._v(\"http://test.com/csrf/withdraw.php?amount=1000&for=hacker\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')])]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[t._v(\"taget\")]),s(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[s(\"span\",{pre:!0,attrs:{class:\"token punctuation attr-equals\"}},[t._v(\"=\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')]),t._v(\"_blank\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')])]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\">\")])]),t._v(\"\\n  重磅消息！！\\n  \"),s(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[s(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"<\")]),t._v(\"a\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"/>\")])]),t._v(\"\\n\")])])]),s(\"ul\",[s(\"li\",[t._v(\"用户点击就会自动发送请求\")])]),t._v(\" \"),s(\"h3\",{attrs:{id:\"两种防护策略\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#两种防护策略\"}},[t._v(\"#\")]),t._v(\" 两种防护策略\")]),t._v(\" \"),s(\"p\",[t._v(\"针对CSRF的两个特点即，：\")]),t._v(\" \"),s(\"ul\",[s(\"li\",[t._v(\"通常发生在第三方域名\")]),t._v(\" \"),s(\"li\",[t._v(\"攻击者只能冒用cookie等信息，无法获取\")])]),t._v(\" \"),s(\"h4\",{attrs:{id:\"阻止不明外域的访问\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#阻止不明外域的访问\"}},[t._v(\"#\")]),t._v(\" 阻止不明外域的访问\")]),t._v(\" \"),s(\"h5\",{attrs:{id:\"同源检测\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#同源检测\"}},[t._v(\"#\")]),t._v(\" 同源检测\")]),t._v(\" \"),s(\"ul\",[s(\"li\",[t._v(\"HTTP头部 Origin和Referer\")]),t._v(\" \"),s(\"li\",[t._v(\"Origin表示请求来源的域名\")]),t._v(\" \"),s(\"li\",[t._v(\"Referer表示请求来源的页面地址\")]),t._v(\" \"),s(\"li\",[t._v(\"阻止外域发起请求\")])]),t._v(\" \"),s(\"h5\",{attrs:{id:\"samesite-cookie\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#samesite-cookie\"}},[t._v(\"#\")]),t._v(\" Samesite Cookie\")]),t._v(\" \"),s(\"ul\",[s(\"li\",[t._v(\"为Set-Cookie响应头新增Samesite属性来表明这个Cookie是一个同站Cookie，同站Cookie不能作为第三方Cookie\")]),t._v(\" \"),s(\"li\",[t._v(\"Samesite属性值：Strict和Lax分别代表严格和宽松模式\")]),t._v(\" \"),s(\"li\",[t._v(\"严格模式下，Cookie不会被包含在请求头中作为第三方Cookie\")]),t._v(\" \"),s(\"li\",[t._v(\"宽松模式下，假如这个请求是这种请求（改变了当前页面或者打开了新页面比如a链接）且同时是个GET请求，则这个Cookie可以作为第三方Cookie\")]),t._v(\" \"),s(\"li\",[t._v(\"不支持子域，当网站有多个子域名时，不能使用SamesiteCookie在主域名存储用户登录信息。每个子域名都需要用户重新登录一次\")])]),t._v(\" \"),s(\"div\",{staticClass:\"language- extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[s(\"code\",[t._v(\"Set-Cookie: foo=1; Samesite=Strict\\nSet-Cookie: bar=2; Samesite=Lax\\nSet-Cookie: baz=3\\n\")])])]),s(\"h4\",{attrs:{id:\"提交时需要附加本域才能获取的信息\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#提交时需要附加本域才能获取的信息\"}},[t._v(\"#\")]),t._v(\" 提交时需要附加本域才能获取的信息\")]),t._v(\" \"),s(\"h5\",{attrs:{id:\"csrf-token\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#csrf-token\"}},[t._v(\"#\")]),t._v(\" CSRF Token\")]),t._v(\" \"),s(\"ul\",[s(\"li\",[t._v(\"为用户请求携带一个攻击者无法获取到的Token\")]),t._v(\" \"),s(\"li\",[t._v(\"用户打开页面时，服务器给用户生成一个Token，一般Token包括随机字符和时间戳的组合，保存在服务器Session中，之后在每次页面加载时，对DOM中所有的a和form标签中的src都加入Token\")]),t._v(\" \"),s(\"li\",[t._v(\"用户在请求是会自动携带这个Token，服务器收到请求会判断Token的时效性并解密进行对比，攻击者无法模拟这个Token\")])]),t._v(\" \"),s(\"h6\",{attrs:{id:\"分布式校验\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#分布式校验\"}},[t._v(\"#\")]),t._v(\" 分布式校验\")]),t._v(\" \"),s(\"p\",[t._v(\"使用Session存储在CSRF Token会带来很大服务器压力，而分布式环境下，用户多次请求可能是不同的服务器，这就需要Session共享，将Session存储在Redis之类的公共存储空间\")]),t._v(\" \"),s(\"p\",[t._v(\"Encrypted Token Pattern：Token不是随机生成，而是使用UserID、时间戳和随机数通过加密生成，不需要存储在Session中用于校验\")]),t._v(\" \"),s(\"h5\",{attrs:{id:\"双重cookie验证\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#双重cookie验证\"}},[t._v(\"#\")]),t._v(\" 双重Cookie验证\")]),t._v(\" \"),s(\"ul\",[s(\"li\",[t._v(\"由于攻击者无法获取Cokie内容，可以让Ajax和表单请求携带一个Cookie的值\")])]),t._v(\" \"),s(\"h3\",{attrs:{id:\"\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#\"}},[t._v(\"#\")])])])}),[],!1,null,null,null);a.default=n.exports}}]);","extractedComments":[]}